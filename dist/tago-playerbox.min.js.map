{"version":3,"sources":["tago-playerbox.js"],"names":["onYouTubeIframeAPIReady","window","tago","playerbox","ready","document","tag","createElement","src","firstScriptTag","getElementsByTagName","parentNode","insertBefore","undefined","onPlayerReady","playerIsReady","elements","loading","remove","isVisible","player","playVideo","onPlayerStateChange","event","data","YT","PlayerState","ENDED","hide","buildElements","triggerSelector","loadingImgSource","div","innerHTML","t","templates","overlay","classes","playerboxContent","close","loadingImgSrc","trigger","querySelector","childNodes","firstElementChild","bindEvents","addEventListener","show","which","keyCode","fadeIn","classList","hideClass","fadeOut","add","stopVideo","seekTo","s","d","p","hasOwnProperty","replace","RegExp","el","style","opacity","fade","val","parseFloat","toFixed","display","requestAnimationFrame","contains","playeroptions","playerVars","autoplay","events","onReady","onStateChange","init","youtubeId","videoId","body","appendChild","videodiv","Player"],"mappings":"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","file":"tago-playerbox.min.js","sourcesContent":["'use strict';\n\n(function(window, document) {\n\tvar tag = document.createElement('script');\n\ttag.src = \"https://www.youtube.com/iframe_api\";\n\n\tvar firstScriptTag = document.getElementsByTagName('script')[0];\n\tfirstScriptTag.parentNode.insertBefore(tag, firstScriptTag);\n})(window, document);\n\n/* jshint unused: false */\nfunction onYouTubeIframeAPIReady() {\n\twindow.tago.playerbox.ready();\n}\n\nvar tago = window.tago === undefined ? {} : window.tago ;\n\n(function(window, document, tago) {\n\tvar player, hideClass = 'tago-playerbox-hide', elements = {}, isVisible = false,\n\tloadingImgSrc = 'tago-playerbox-loading.gif',playerIsReady = false, playeroptions = {\n\t\tplayerVars: {\n\t\t\tautoplay: 0\n\t\t},\n\t\tevents: {\n\t\t\tonReady: onPlayerReady,\n\t\t\tonStateChange: onPlayerStateChange\n\t\t}\n\t};\n\n\tvar classes = {\n\t\toverlay: 'tago-overlay',\n\t\tplayerbox: 'tago-playerbox',\n\t\tplayerboxContent: 'tago-playerbox-content',\n\t\tclose: 'tago-playerbox-close',\n\t\thide: 'tago-playerbox-hide',\n\t\tloading: 'tago-playerbox-loading'\n\t};\n\n\tvar templates = {\n\t\toverlay: '<div class=\"{overlay} {hide}\"></div>',\n\t\tplayerbox: '<div class=\"{playerbox} {hide}\"><div class=\"{playerboxContent}\"><div></div><span class=\"{close}\">&times;</span></div></div>',\n\t\tloading: '<div class=\"{loading} {hide}\"><img src=\"{loadingImgSrc}\" alt=\"Loading indicator\" /></div>'\n\t};\n\n\n\ttago.playerbox = {\n\n\t\t/**\n\t\t * Initializes the component by building and adding all the necessary elements to the body. There will\n\t\t * not be any events attached to the elements yet.\n\t\t * This function should be called only once by the onYouTubeIframeAPIReady function.\n\t\t * @param  {String} triggerSelector the css selector to the element that will trigger the video\n\t\t * @param  {String} youtubeId       the youtube id of the video that should be displayed\n\t\t * @param  {String} loadingImgSrc \tthe path to the loading image. Default is root\n\t\t * @return {undefined}\n\t\t */\n\t\tinit: function(triggerSelector, youtubeId, loadingImgSource) {\n\t\t\tbuildElements(triggerSelector, loadingImgSource);\n\t\t\tplayeroptions.videoId = youtubeId;\n\t\t\tdocument.body.appendChild(elements.overlay);\n\t\t\tdocument.body.appendChild(elements.loading);\n\t\t},\n\n\t\t/**\n\t\t * Initializes the YT player and appends it. The events to show and hide the modal are binded to the\n\t\t * elements.\n\t\t * @return {undefined}\n\t\t */\n\t\tready: function () {\n\t\t\tvar videodiv = elements.playerbox.firstElementChild.firstElementChild;\n\t\t\tplayer = new YT.Player(videodiv, playeroptions);\n\t\t\tdocument.body.appendChild(elements.playerbox);\n\t\t\tbindEvents();\n\t\t}\n\t};\n\n\t/**\n\t * Remove the Loading indicator and play the video if the modal is opened\n\t * @return {[type]} [description]\n\t */\n\tfunction onPlayerReady () {\n\t\tplayerIsReady = true;\n\t\telements.loading.remove();\n\t\tif (isVisible) {\n\t\t\tplayer.playVideo();\n\t\t}\n\t}\n\n\t/**\n\t * It will hide the modal when the video ends\n\t * @param  {Object} event the event data\n\t * @return {undefined}\n\t */\n\tfunction onPlayerStateChange (event) {\n\t\tif (event.data === YT.PlayerState.ENDED) {\n\t\t\thide();\n\t\t}\n\t}\n\n\tfunction buildElements (triggerSelector, loadingImgSource) {\n\t\tvar div = document.createElement('div');\n\t\tdiv.innerHTML = t(templates.overlay, { overlay: classes.overlay, hide: classes.hide }) +\n\t\t\t\t\t\tt(templates.playerbox, {\n\t\t\t\t\t\t\tplayerbox: classes.playerbox,\n\t\t\t\t\t\t\thide: classes.hide,\n\t\t\t\t\t\t\tplayerboxContent: classes.playerboxContent,\n\t\t\t\t\t\t\tclose: classes.close\n\t\t\t\t\t\t}) +\n\t\t\t\t\t\tt(templates.loading, { loading: classes.loading, hide: classes.hide, loadingImgSrc: loadingImgSource || loadingImgSrc });\n\t\telements.trigger = document.querySelector(triggerSelector);\n\t\telements.overlay = div.childNodes[0];\n\t\telements.playerbox = div.childNodes[1];\n\t\telements.close = elements.playerbox.firstElementChild.childNodes[1];\n\t\telements.loading = div.childNodes[2];\n\t}\n\n\tfunction bindEvents () {\n\t\telements.trigger.addEventListener('click', function () {\n\t\t\tshow();\n\t\t});\n\n\t\telements.close.addEventListener('click', function () {\n\t\t\thide();\n\t\t});\n\n\t\tdocument.addEventListener('keyup', function (event) {\n\t\t\tif ((event.which === 27 || event.keyCode === 27) && isVisible) {\n\t\t\t\thide();\n\t\t\t}\n\t\t});\n\t}\n\n\tfunction show() {\n\t\tisVisible = true;\n\t\tfadeIn(elements.overlay);\n\t\telements.playerbox.classList.remove(hideClass);\n\t\telements.loading.classList.remove(hideClass);\n\t\tif (playerIsReady) {\n\t\t\tplayer.playVideo();\n\t\t}\n\t}\n\n\t/**\n\t * Hides the modal and the video player. It will also stop the video and reward it back to 0s.\n\t * @return {undefined}\n\t */\n\tfunction hide() {\n\t\tisVisible = false;\n\t\tfadeOut(elements.overlay);\n\t\telements.playerbox.classList.add(hideClass);\n\t\telements.loading.classList.add(hideClass);\n\t\tif (playerIsReady) {\n\t\t\tplayer.stopVideo();\n\t\t\tplayer.seekTo(0, true);\n\t\t}\n\t}\n\n\tfunction t(s, d) {\n\t\tfor (var p in d) {\n\t\t\tif (d.hasOwnProperty(p)) {\n\t\t\t\ts = s.replace(new RegExp('{' + p + '}', 'g'), d[p]);\n\t\t\t}\n\t\t}\n\t\treturn s;\n\t}\n\n\t/**\n\t * Fade Out animation\n\t * @param  {DOMElement} el \t\tthe element to be animated\n\t * @return {undefined}\n\t */\n\tfunction fadeOut(el){\n\t\tel.style.opacity = 1;\n\n\t\t(function fade() {\n\t\t\tvar val = parseFloat(el.style.opacity);\n\t\t\tval = (val - 0.1).toFixed(1);\n\t\t\tif (val < 0) {\n\t\t\t\tel.style.display = \"none\";\n\t\t\t\tel.classList.add('tago-playerbox-hide');\n\t\t\t} else {\n\t\t\t\tel.style.opacity  = val;\n\t\t\t\trequestAnimationFrame(fade);\n\t\t\t}\n\t\t})();\n\t}\n\n\t/**\n\t * Fade In animation\n\t * @param  {DOMElement} el      the element to be animated\n\t * @param  {String} display \tthe final display type. Default: block\n\t * @return {undefined}\n\t */\n\tfunction fadeIn(el, display){\n\t\tif (el.classList.contains('tago-playerbox-hide')){\n\t\t\tel.classList.remove('tago-playerbox-hide');\n\t\t}\n\t\tel.style.opacity = 0;\n\t\tel.style.display = display || \"block\";\n\n\t\t(function fade() {\n\t\t\tvar val = parseFloat(el.style.opacity);\n\t\t\tif (((val += 0.2) < 1)) {\n\t\t\t\tel.style.opacity = val;\n\t\t\t\trequestAnimationFrame(fade);\n\t\t\t}\n\t\t})();\n\t}\n\n})(window, document, tago);\n"],"sourceRoot":"/source/"}